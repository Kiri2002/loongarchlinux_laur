pkgname=qshell
pkgver=2.7.0
pkgrel=1
pkgdesc="CLI tool for Qiniu"
arch=('loongarch64' 'x86_64')
url="https://github.com/qiniu/qshell"
license=('MIT')
provides=('qshell')
source=("qshell-2.7.0.tar.gz::https://github.com/qiniu/qshell/archive/refs/tags/v${pkgver}.tar.gz")
sha256sums=('a580b97e86fa2bf4e9b258361d37ec74d3f38ab0b153ddbbadb793d932409a94')

prepare() {
  cd $srcdir
  git clone https://github.com/loongson/sys.git
}

build() {
  cd "$pkgname-$pkgver"

  export GOPATH="$srcdir/build:/usr/share/gocode"
  go mod edit -replace=golang.org/x/sys@v0.0.0-20220128215802-99c3d69c2c27=$srcdir/sys

  go build -v
}

package() {
  cd "$pkgname-$pkgver"

  install -Dm755 qshell "${pkgdir}/usr/bin/qshell"
}
